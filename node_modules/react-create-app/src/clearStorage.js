export default ({ fire = process.env.NODE_ENV !== 'development', debug = true }) => {
    if(!fire)
        return;

    try {
        let previousBundleHash = localStorage.bundleHash;
        let currentBundleHash = document.querySelector('script[src*=app]').src.match(/\?(.+?)$/)[1];

        if(previousBundleHash !== currentBundleHash) {
            if(debug)
                console.warn('Clearing localStorage', previousBundleHash, '=>', currentBundleHash);
            localStorage.clear();
            localStorage.setItem('bundleHash', currentBundleHash);
        }
        else {
            if(debug)
                console.warn('Preserving localStorage', currentBundleHash);
        }
    }
    catch(error) {
        console.error('clearStorage', error);
    }
};